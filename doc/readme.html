<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.11.4">
    <title>Alice – alice v0.1.1</title>
    <link rel="stylesheet" href="dist/app-1e374caa3d.css" />
    <script src="dist/sidebar_items.js"></script>
  </head>
  <body data-type="extras">

<div class="main">
<button class="sidebar-toggle">
  <i class="icon-menu"></i>
</button>
<section class="sidebar">
  <button class="sidebar-toggle">
    <i class="icon-menu"></i>
  </button>

  
  <a href="api-reference.html" class="sidebar-projectLink">
    <div class="sidebar-projectDetails">
      <h1 class="sidebar-projectName">
        alice
      </h1>
      <h2 class="sidebar-projectVersion">
        v0.1.1
      </h2>
    </div>
    
      <img src="assets/logo.png" alt="alice" class="sidebar-projectImage">
    
  </a>

  <div class="sidebar-search">
    <i class="icon-search"></i>
    <input type="text" class="sidebar-searchInput" placeholder="search" autocomplete="off" />
  </div>

  <ul class="sidebar-listNav">
    <li><a id="extras-list" href="#full-list">Pages</a></li>

    
      <li><a id="modules-list" href="#full-list">Modules</a></li>
    

    

    
  </ul>

  <ul id="full-list" class="sidebar-fullList"></ul>
  <div class="sidebar-noResults"></div>
</section>

<section class="content">
  <div id="content" class="content-inner">


<h1>Alice</h1>
<p><img src="http://i.imgur.com/UndMkm3.png" alt=""/></p>
<p><a href="https://hex.pm/packages/alice"><img src="https://img.shields.io/hexpm/l/alice.svg" alt="Hex.pm"/></a>
<a href="https://hex.pm/packages/alice"><img src="https://img.shields.io/hexpm/v/alice.svg" alt="Hex.pm"/></a>
<a href="https://hex.pm/packages/alice"><img src="https://img.shields.io/hexpm/dt/alice.svg" alt="Hex.pm"/></a></p>
<p>A Lita-inspired Slack bot written in Elixir.</p>
<p>Very much a work in progress, but it works well enough.</p>
<p>For an example bot, see the <a href="https://github.com/adamzaninovich/awesome_friendz_alice" title="">awesome_friendz_alice</a> bot. For an example
handler, see <a href="https://github.com/adamzaninovich/alice_google_images" title="">alice_google_images</a>.</p>
<p>You’ll need a Slack API token which can be retrieved from the <a href="https://api.slack.com/web" title="">Web API page</a> or
by creating a new <a href="https://my.slack.com/services/new/bot" title="">bot integration</a>.</p>
<h2 id="creating-your-own-bot-with-alice"> Creating Your Own Bot With Alice</h2><h3>Create the Project</h3>
<p>Create a new mix project.</p>
<pre><code class="sh">mix new my_bot
cd my_bot
rm lib/my_bot.ex</code></pre>
<h3>Configure the Application</h3>
<p>In <code class="inline">mix.exs</code>, bring in alice and any other handlers you want. You also need to
include the <code class="inline">websocket_client</code> dependency because it’s not a <a href="http://hex.pm" title="">hex</a> package.</p>
<pre><code class="elixir">defp deps do
  [
    {:websocket_client, github: &quot;jeremyong/websocket_client&quot;},
    {:alice,                  &quot;~&gt; 0.1.0&quot;},
    {:alice_against_humanity, &quot;~&gt; 0.0.1&quot;},
    {:alice_google_images,    &quot;~&gt; 0.0.1&quot;}
  ]
end</code></pre>
<p>In the same file, configure the app, registering any handlers you want. You can
add handlers through dependencies, or you can write them directly in your bot
instance. (We recommend putting them in <code class="inline">lib/alice/handlers/my_handler.ex</code>)</p>
<pre><code class="elixir">def application do
  [ applications: [:alice],
    mod: {
      Alice, [
        Alice.Handlers.Random,
        Alice.Handlers.AgainstHumanity,
        Alice.Handlers.GoogleImages
      ] } ]
end</code></pre>
<p>In <code class="inline">config/config.exs</code> add any configuration that your bot needs.</p>
<pre><code class="elixir">use Mix.Config

config :alice,
  api_key: System.get_env(&quot;SLACK_API_TOKEN&quot;),
  state_backend: :redis,
  redis: System.get_env(&quot;REDIS_URL&quot;)

config :alice_google_images,
  cse_id: System.get_env(&quot;GOOGLE_CSE_ID&quot;),
  cse_token: System.get_env(&quot;GOOGLE_CSE_TOKEN&quot;),
  safe_search_level: :medium</code></pre>
<p>With that, you’re done! Run your bot with <code class="inline">iex -S mix</code> or <code class="inline">mix run --no-halt</code>.</p>
<h3>Deploying to Heroku</h3>
<p>Create a new heroku app running Elixir.</p>
<pre><code class="sh">heroku create --buildpack &quot;https://github.com/HashNuke/heroku-buildpack-elixir.git&quot;</code></pre>
<p>Create a file called <code class="inline">heroku_buildpack.config</code> at the root of your project.</p>
<pre><code class="sh">erlang_version=18.2.1
elixir_version=1.2.1
always_rebuild=false

post_compile=&quot;pwd&quot;</code></pre>
<p>Create a <code class="inline">Procfile</code> at the root of your project. If you don’t create the proc as
a <code class="inline">worker</code>, Heroku will assume it’s a web process and will terminate it for not
binding to port 80.</p>
<pre><code class="ruby">worker: mix run --no-halt</code></pre>
<p>You may also need to reconfigure Heroku to run the worker.</p>
<pre><code class="sh">heroku ps:scale web=0 worker=1</code></pre>
<p>Add your slack token and any other environment variables to Heroku</p>
<pre><code class="sh">heroku config:set SLACK_API_TOKEN=xoxb-23486423876-HjgF354JHG7k567K4j56Gk3o</code></pre>
<p>Push to Heroku</p>
<pre><code class="sh">git add -A
git commit -m &quot;initial commit&quot;
git push heroku master</code></pre>
<p>Your bot should be good to go. :metal:</p>
<h2 id="creating-a-route-handler-plugin"> Creating a Route Handler Plugin</h2><h3>First Steps</h3>
<pre><code class="sh">mix new alice_google_images
cd alice_google_images
rm lib/alice_google_images.ex
mkdir -p lib/alice/handlers
touch lib/alice/handlers/google_images.ex</code></pre>
<h3>Configuring the App</h3>
<p>In <code class="inline">mix.exs</code>, update <code class="inline">application</code> and <code class="inline">deps</code> to look like the following:</p>
<pre><code class="elixir">def application do
  [applications: []]
end

defp deps do
  [
    {:websocket_client, github: &quot;jeremyong/websocket_client&quot;},
    {:alice, &quot;~&gt; 0.1.0&quot;}
  ]
end</code></pre>
<h3>Writing Route Handlers</h3>
<p>In <code class="inline">lib/alice/handlers/google_images.ex</code>:</p>
<pre><code class="elixir">defmodule Alice.Handlers.GoogleImages do
  use Alice.Router

  command ~r/(image|img)\s+me (?&lt;term&gt;.+)/i, :fetch
  route   ~r/(image|img)\s+me (?&lt;term&gt;.+)/i, :fetch

  def handle(conn, :fetch) do
    conn
    |&gt; extract_term
    |&gt; get_images
    |&gt; select_image
    |&gt; reply(conn)
  end

  #...
end</code></pre>
<h3>Registering Handlers</h3>
<p>In the <code class="inline">mix.exs</code> file of your bot, add your handler to the list of handlers to
register on start</p>
<pre><code class="elixir">def application do
  [ applications: [:alice],
    mod: {Alice, [Alice.Handlers.GoogleImages, ...] } ]
end</code></pre>

    <footer class="footer">
      <p>
        <span class="line">
          Built using
          <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" rel="help" target="_blank">ExDoc</a> (v0.11.4),
        </span>
        <span class="line">
          designed by
          <a href="https://twitter.com/dignifiedquire" target="_blank" title="@dignifiedquire">Friedel Ziegelmayer</a>.
          </span>
      </p>
      <button class="night-mode-toggle" />
    </footer>
  </div>
</section>
</div>
  <script src="dist/app-6d2e071366.js"></script>
  </body>
</html>

